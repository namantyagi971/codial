<link rel="stylesheet" href="/css/home.css">
<h1> Codial Home Page  </h1>

<!-- section corresponding to posts -->
<section id="feed-posts">
    <!-- if the user is signed in, then only show the form -->
    <% if(locals.user) { %>
    <h2>Posts</h2>
    <form action="/posts/create" id="new-post-form" method="POST">
        <textarea name="content"  cols="30" rows="3" placeholder="Type here..."></textarea>
        <input type="submit" value="Post">
    </form>
    <% } %>
</section>

<!-- section that includes all post of user -->
<section id = "show-posts">
    <h2> All Posts</h2>
    <ul id ="post-content">
     <% for(let post of allposts) { %>
        <li> 
            <% if((locals.user) && (locals.user.id==post.user.id)) { %>
              <small>
                 <a href="posts/delete/?id=<%= post._id %>">X</a> 
              </small>
              <% } %>
              <p> <%= post.content %> </p>
              <p> <%= post.user.name %> </p>
              <% if(locals.user) { %>
                <!-- form for comments -->
              <div class="post-comments">
                <form action="/comments/create" method="POST">
                    <input type="text" name ="content" placeholder="Add comment ..."></textarea>
                    <input type="hidden" name="post" value="<%= post._id %>">
                    <input type="submit" value="Post Comment">
                </form>
              </div>
              <% } %>
              <!-- to display comments and author of comments -->
              <div class="post-comments-list">
                  <ul type="square" id = "post-comments-<%= post._id %>">
                      <% for(let comment of post.comments) { %>
                        <li>
                            <%= comment.content %>
                            <br>
                            <%= comment.user.name %>
                        </li>
                      <% } %>
                  </ul>
              </div>
        </li>
     <% } %>
    </ul>
</section>